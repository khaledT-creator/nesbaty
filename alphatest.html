<!DOCTYPE html>
<html lang="ar" >
<head>
  <meta charset="UTF-8" />
  <title>حاسبة النسبة الموزونة - تصميم جميل ومرتب</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo&display=swap');
    *, *::before, *::after {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 20px;
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #333;
      direction: rtl;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }
    .container {
      background: #fff;
      border-radius: 16px;
      max-width: 460px;
      width: 100%;
      padding: 30px 35px 40px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.15);
      box-sizing: border-box;
    }
    h1, h2 {
      text-align: center;
      color: #5a2d82;
      text-shadow: 0 3px 8px rgba(90,45,130,0.3);
    }
    h1 {
      margin-bottom: 30px;
      font-weight: 900;
      font-size: 2.2rem;
    }
    h2 {
      margin-bottom: 25px;
      font-weight: 700;
      font-size: 1.8rem;
    }
    label {
      font-weight: 700;
      font-size: 15px;
      color: #5a2d82;
      display: block;
      margin-bottom: 8px;
    }
    select, input[type="number"] {
      width: 100%;
      padding: 12px 16px;
      border-radius: 12px;
      border: 2px solid #bfa5d9;
      font-size: 16px;
      font-weight: 600;
      color: #4a3174;
      box-sizing: border-box;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      background: #f9f7fd;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
    }
    select:hover, select:focus, input[type="number"]:focus {
      border-color: #7749c7;
      outline: none;
      box-shadow: 0 0 8px #8b6edeaa;
      background: #fff;
    }
    input[type="number"] {
      text-align: center;
      margin-bottom: 18px;
    }
    button {
      width: 100%;
      background: #5a2d82;
      color: #fff;
      font-size: 1.3rem;
      font-weight: 900;
      border: none;
      padding: 16px 0;
      border-radius: 14px;
      margin-top: 25px;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(90, 45, 130, 0.6);
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
    }
    button:hover {
      background: #7b56c1;
      box-shadow: 0 8px 24px rgba(123, 86, 193, 0.85);
    }
    #result {
      margin-top: 30px;
      font-weight: 900;
      font-size: 1.5rem;
      color: #4c1d95;
      text-align: center;
      user-select: none;
      text-shadow: 0 2px 8px #a083d2cc;
    }
    #report {
      margin-top: 25px;
      background: #e8e5fc;
      border-radius: 14px;
      padding: 20px;
      color: #3a2462;
      box-shadow: 0 6px 18px rgba(90, 45, 130, 0.25);
      font-weight: 700;
      line-height: 1.4;
      font-size: 1rem;
    }
    #report ul {
      padding-inline-start: 20px;
      margin: 10px 0 15px;
      color: #4a3174;
      font-weight: 600;
    }
    section { display: none; }
    .active { display: block; }
    /* Responsive */
    @media (max-width: 480px) {
      body {
        padding: 15px 10px;
      }
      .container {
        padding: 25px 20px 30px;
        max-width: 100%;
        box-shadow: 0 15px 30px rgba(0,0,0,0.12);
      }
      h1 {
        font-size: 1.8rem;
        margin-bottom: 25px;
      }
      input[type="number"], select {
        font-size: 17px;
        padding: 10px;
      }
      button {
        font-size: 1.25rem;
        padding: 14px 0;
      }
    }
    .ad-placeholder {
      background: #eee;
      border: 2px dashed #999;
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
      color: #666;
      font-weight: 600;
      font-style: italic;
    }
  </style>
</head>
<body>
  <div class="container">

    <section id="selectGrade" class="active">
      <h1>حاسبة النسبة الموزونة</h1>
      <label for="gradeSelect">اختر الصف:</label>
      <select id="gradeSelect">
        <option value="">-- اختر الصف --</option>
        <option value="third_secondary_first_term">ثالث ثانوي - ترم أول</option>
        <option value="second_secondary">ثاني ثانوي</option>
        <option value="first_secondary">أول ثانوي</option>
      </select>
      
      <!-- إعلان هنا -->
      <div class="ad-placeholder">* إعلان في صفحة اختيار الصف *</div>
      
      <button onclick="goToForm()">التالي</button>
    </section>

    <section id="gradeFormSection">
      <h2>أدخل درجات المواد</h2>

      <!-- إعلان هنا -->
      <div class="ad-placeholder">* إعلان في صفحة إدخال الدرجات *</div>

      <form id="gradeForm" >
        <!-- الموضوعات معاد إنشاؤها تلقائياً -->
      </form>
      <button onclick="showAd()">احسب النسبة الكلية</button>
    </section>

    <section id="adSection">
      <h2>* هنا الإعلان قبل النتيجة *</h2>
      <p>... يرجى الانتظار</p>
      
      <!-- إعلان إضافي هنا -->
      <div class="ad-placeholder">* إعلان مؤقت أثناء الانتظار *</div>
    </section>

    <section id="resultSection">
      <h2>النتيجة</h2>

      <!-- إعلان هنا -->
      <div class="ad-placeholder">* إعلان في صفحة النتيجة *</div>

      <div id="result"></div>
      <div id="report"></div>
      <button onclick="restart()">إعادة الحساب</button>
    </section>

  </div>

<script>
  const weightsByGrade = {
    "third_secondary_first_term": {
      "البحث": 7.69,
      "التقنيه": 7.69,
      "كيمياء": 11.54,
      "علوم أرض": 11.54,
      "تربيه صحيه": 11.54,
      "رياضيات": 15.38,
      "إنجليزي": 15.38,
      "فيزياء": 19.23
    },
    "second_secondary": {},
    "first_secondary": {}
  };

  const selectGradeSection = document.getElementById('selectGrade');
  const gradeFormSection = document.getElementById('gradeFormSection');
  const adSection = document.getElementById('adSection');
  const resultSection = document.getElementById('resultSection');
  const gradeForm = document.getElementById('gradeForm');
  const resultDiv = document.getElementById('result');
  const reportDiv = document.getElementById('report');
  const gradeSelect = document.getElementById('gradeSelect');

  function showSection(section) {
    [selectGradeSection, gradeFormSection, adSection, resultSection].forEach(s => s.style.display = 'none');
    section.style.display = 'block';
  }

  function goToForm() {
    const grade = gradeSelect.value;
    if (!grade || !weightsByGrade[grade] || Object.keys(weightsByGrade[grade]).length === 0) {
      alert("الرجاء اختيار صف صحيح مع مواد مفعلة.");
      return;
    }

    // مسح النموذج القديم
    gradeForm.innerHTML = '';

    // إنشاء الحقول للمواد
    const weights = weightsByGrade[grade];
    for (const subject in weights) {
      const div = document.createElement('div');
      div.className = 'subject-card';
      div.innerHTML = `
        <div class="subject-name">${subject} (${weights[subject]}%)</div>
        <input type="number" name="${subject}" min="0" max="100" value="100" />
      `;
      gradeForm.appendChild(div);
    }

    showSection(gradeFormSection);
  }

  function showAd() {
    const grade = gradeSelect.value;
    const weights = weightsByGrade[grade];
    let subjectDetails = [];

    for (const subject in weights) {
      const input = gradeForm.querySelector(`input[name="${subject}"]`);
      if (!input) {
        alert("خطأ في النموذج");
        return;
      }
      const val = parseFloat(input.value);
      if (isNaN(val) || val < 0 || val > 100) {
        alert(`الرجاء إدخال درجة صحيحة بين 0 و 100 في مادة ${subject}`);
        return;
      }
      subjectDetails.push({name: subject, grade: val, weight: weights[subject]});
    }

    showSection(adSection);

    setTimeout(() => {
      calculateAndShow(subjectDetails);
    }, 2000);
  }

  function calculateAndShow(subjectDetails) {
    let totalLost = 0;
    for (const sub of subjectDetails) {
      totalLost += (100 - sub.grade) * (sub.weight / 100);
    }
    const total = 100 - totalLost;

    resultDiv.textContent = `النسبة الكلية: ${total.toFixed(2)}%`;

    subjectDetails.sort((a,b) => b.grade - a.grade);

    const bestSubjects = subjectDetails.slice(0,3);
    const worstSubjects = subjectDetails.slice(-3).reverse();

    let reportHTML = `<strong>أفضل المواد:</strong><ul>`;
    bestSubjects.forEach(sub => {
      reportHTML += `<li>${sub.name}: الدرجة ${sub.grade}%, الوزن ${sub.weight}%</li>`;
    });
    reportHTML += `</ul>`;

    reportHTML += `<strong>أقل المواد:</strong><ul>`;
    worstSubjects.forEach(sub => {
      reportHTML += `<li>${sub.name}: الدرجة ${sub.grade}%, الوزن ${sub.weight}%</li>`;
    });
    reportHTML += `</ul>`;

    const lowest = worstSubjects[0];
    if(lowest.grade < 70) {
      reportHTML += `<p>ننصح بالتركيز على مادة <strong>${lowest.name}</strong> لأنها ذات وزن ${lowest.weight}% ودرجتك فيها منخفضة.</p>`;
    } else {
      reportHTML += `<p>أداءك جيد في جميع المواد، استمر على هذا المستوى!</p>`;
    }

    reportDiv.innerHTML = reportHTML;

    showSection(resultSection);
  }

  function restart() {
    gradeSelect.value = "";
    gradeForm.innerHTML = "";
    resultDiv.textContent = "";
    reportDiv.textContent = "";
    showSection(selectGradeSection);
  }

  showSection(selectGradeSection);
</script>

</body>
</html>